%YAML 1.1
---
# Snapcraft Recipe for SimpleScreenRecorder
# ------------------------------
# This file is in the YAML data serialization format:
# http://yaml.org
# For the spec. of writing this file refer the following documentation:
# * The snapcraft format
#   https://docs.snapcraft.io/the-snapcraft-format/8337
# * Snap Documentation
#   https://docs.snapcraft.io
# * Topics under the doc category in the Snapcraft Forum
#   https://forum.snapcraft.io/c/doc
# For support refer to the snapcraft section in the Snapcraft Forum:
# https://forum.snapcraft.io/c/snapcraft
name: simplescreenrecorder
title: SimpleScreenRecorder (UNOFFICIAL)
summary: A screen recorder for Linux
description: |
  SimpleScreenRecorder is a screen recorder for Linux. Despite the name, this program is actually quite complex. It's 'simple' in the sense that it's easier to use than ffmpeg/avconv or VLC :).

  NOTE: This is NOT an official SimpleScreenRecorder distribution, refer [the snap's issue tracker](https://github.com/Lin-Buo-Ren/simplescreenrecorder-snap/issues) for support.

icon: snap/gui/simplescreenrecorder.png
license: GPL-3.0
#version: determined-by-adopt-info

adopt-info: main
base: core18
confinement: devmode
grade: devel

parts:
  # Files to patch the files in the snap
  patching:
    source: snap/local/patching
    plugin: dump
    organize:
      '*': patching/
    prime:
    - -*

  # Launcher programs to fix problems at runtime
  launchers:
    source: snap/local/launchers
    plugin: dump
    organize:
      '*': bin/
    stage:
    - -bin/README.*

  # Programs to modify the behavior of each step of the snapcraft lifecycles
  scriptlets:
    source: snap/local/scriptlets
    plugin: dump
    organize:
      '*': scriptlets/
    prime:
    - -*

  # Remote part for support of various desktop technologies
  # Refer: https://github.com/ubuntu/snapcraft-desktop-helpers/blob/master/snapcraft.yaml
  desktop-qt5:
    source: https://github.com/ubuntu/snapcraft-desktop-helpers.git
    source-depth: 1
    source-subdir: qt

    plugin: make
    make-parameters: ["FLAVOR=qt5"]
    build-packages:
    - build-essential
    - qtbase5-dev
    - dpkg-dev
    stage-packages:
    - libxkbcommon0
    - ttf-ubuntu-font-family
    - dmz-cursor-theme
    - light-themes
    - adwaita-icon-theme
    - gnome-themes-standard
    - shared-mime-info
    - libqt5gui5
    - libgdk-pixbuf2.0-0
    - libqt5svg5 # for loading icon themes which are svg
    - try: [appmenu-qt5] # not available on core18
    - locales-all
    - xdg-user-dirs
    - fcitx-frontend-qt5

  main:
    after:
    # for patch-desktop-entries.*
    - patching

    # for override-pull script
    - scriptlets

    source: https://github.com/MaartenBaert/ssr.git
    source-tag: 0.3.11
    source-depth: 1
    override-pull: |
      set -o nounset
      snapcraftctl pull
      "${SNAPCRAFT_STAGE}"/scriptlets/main-adopt-info

    plugin: cmake
    build-packages:
    - pkg-config

    override-prime: |
      set \
        -o nounset

      snapcraftctl prime

      "${SNAPCRAFT_STAGE}"/patching/patch-desktop-entries.bash

apps:
  simplescreenrecorder:
    adapter: full
    command: bin/simplescreenrecorder
    command-chain:
    - bin/desktop-launch
    - bin/simplescreenrecorder-launch

    #desktop: share/applications/simplescreenrecorder.desktop

plugs:
  # For snaps with a graphical user interface:
  desktop:
  desktop-legacy:
  x11:
  unity7:
  wayland:

  # Storage access
  #home:
  #removable-media: # Non-A/C

  # Network access
  #network:

#slots:
